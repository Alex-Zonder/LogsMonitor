<style media="screen">
.Bread {
	cursor:pointer;
	float:left;
}
.Bread:hover {
	color: teal;
}

.File {
	width:100%;
	cursor:pointer;
	display:block-inline;
}
.File:hover {
	color: teal;
}
.Directory {
	width:100%;
	cursor:pointer;
	display:block-inline;
	color:black;
}
.Directory:hover {
	color: teal;
}
</style>


<div class="Head" id="Head_Files"></div>
<div class="Body_Block" style="height:calc(100% - 62px);">
  <div id="File_Manager" style="width:calc(25% - 1px);border-right:1px solid black;float:left;height:100%;overflow:auto;background:var(--color_2);"></div>
  <div  id="File_Bowser"style="width:75%;float:left;height:100%;overflow:auto;-webkit-user-select: text;"></div>
</div>
<div class="Foot">
	<div id="File_Info_Dir" style="width:50%;float:left;text-align:left;"></div>
	<div id="File_Info_File" style="width:50%;float:right;text-align:right;"></div>
</div>




<script type="text/javascript">
function HtmlToView (data) {
	data = data.replace(new RegExp('<','g'), "&lt");
	data = data.replace(new RegExp('\r?\n','g'), "<br>");
	data = data.replace(new RegExp(" ",'g'), "&nbsp;");
	data = data.replace(new RegExp("\t",'g'), "&nbsp;&nbsp;&nbsp;&nbsp;");
	return data;
}

function DrawBreadroom (pach) {
	var dirs = pach.split('/');
	var pach = "/";
	var html = "<div class='Bread' onclick='OpenDir(\"/\")'>Корень/</div>";
	for (var x=1; dirs[x]; x++) {
		pach += dirs[x] + "/";
		html += "<div class='Bread' onclick='OpenDir(\"" + pach + "\")'>" + dirs[x] + "/</div>";
	}
	document.getElementById("Head_Files").innerHTML = html;
}


function OpenFile (pach,file) {
	var data = ReadFileSync (pach + file);

	var file_lenght = data.length;
	var str_counter = data.split('\n').length;

	data = HtmlToView(data);

	File_Bowser.innerHTML = Hilight(data);
	//File_Bowser_Textarea.innerHTML = data;

	DrawBreadroom (pach + file);

	if (file_lenght<1024) file_lenght += " Б";
	else if (file_lenght<1024*1024) file_lenght = (file_lenght / 1024).toFixed(2) + " кБ";
	else if (file_lenght<1024*1024*1024) file_lenght = (file_lenght / 1024 / 1024).toFixed(2) + " мБ";
	File_Info_File.innerHTML = "Строк: " + str_counter + " | Размер: " + file_lenght;
}

/*function ViewFileInTerminal (pach,file) {
  MenuOpen('Trminal');
  Input_Exec_Command.value = 'cat ' + pach + file;
  Input_Grep.value = '';
  RunCommand();
}*/



function DrawDir (pach,file) {
	var html = "<div class='Directory' onclick=\"OpenDir(\'" + pach + file + "/\')\">" + file + '</div>';
	File_Manager.innerHTML += html;
}

function DrawFile (pach,file) {
	var html = "<div class='File' onclick=\"OpenFile(\'" + pach + "\',\'" + file + "\')\">" + file + '</div>';
	//var hil = require('./settings.js');
	//html = hil.Hilight (html);
	File_Manager.innerHTML += html;
}

var root_pach = __dirname + "/";
var pach = root_pach;
//var pach = '/Users/aleksandrpilipenko/myhome/logs/myhome/';
function OpenDir (pach) {
	File_Manager.innerHTML = "";
	ReadDirToArraySync (pach, function (files) {
		DrawBreadroom (pach);
		var dirs_counter = 0;
		for (var x=0; files[x]; x++) {
			if (!files[x]['isFile']) {
				DrawDir (pach,files[x]['name']);
				dirs_counter++;
			}
		}
		var files_counter = 0;
		for (var x=0; files[x]; x++) {
			if (files[x]['isFile']) {
				DrawFile (pach,files[x]['name']);
				files_counter++;
			}
		}
		//File_Manager.innerHTML += "<hr>" + ToJson(files);
		File_Info_Dir.innerHTML = "Папок: " + dirs_counter + " | Файлов: " + files_counter;
	});
}
OpenDir(pach);
</script>
